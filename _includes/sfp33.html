<!-- Students for Peace Section -->
<section class="content-section" id="students-for-peace">
  <h2 class="section-title">Students for Peace</h2>
  <div class="sfp-card">
    
    <div class="sfp-content">
      <div class="sfp-text-with-bg">
        <!-- Large background candle (shown by default) -->
        <div class="sfp-candles-bg" id="sfp-largeCandleBg" style="display: block;">
          <div class="sfp-candle">
            <div class="sfp-flame-container">
              <div class="sfp-flame-glow lit"></div>
              <div class="sfp-flame lit">
                <div class="sfp-flame-core"></div>
              </div>
              <div class="sfp-wick"></div>
            </div>
            <div class="sfp-candle-body"></div>
            <div class="sfp-candle-base"></div>
          </div>
        </div>

     <p class="sfp-years-ago">33 Years Ago...</p>
        <p>On 13 February 1993, approximately 5,000 school and college students gathered along Mahatma Gandhi Road in Bangalore for a candlelight demonstration organised by <a href="/articles/students-for-peace/"><strong>Students for Peace</strong></a>. The event emerged in response to communal tensions following the Babri Masjid demolition on 6 December 1992 and subsequent violence across India. At dusk, students lit candles from a common flame at the Gandhi statue, passing light down the boulevard in a symbolic gesture of unity and non-violence.</p>
        
        <p>Students for Peace was initiated by engineering student Sunil Abraham from Dayananda Sagar College of Engineering, working alongside Ravindra Walters from St. Joseph's College. The platform deliberately excluded political organisations, religious groups, and prominent figures to maintain its character as an independent student-led initiative. Around 80 volunteers coordinated logistics, permissions, and crowd management with minimal institutional backing, relying instead on grassroots networks and voluntary contributions.</p>
      </div>
      
      <!-- Show/Hide candle link - right aligned -->
      <div class="sfp-candle-toggle-line">
        <button type="button" class="sfp-candle-link" id="sfp-toggleLargeCandleLink" aria-expanded="true" aria-controls="sfp-largeCandleBg">
          üïØÔ∏è <strong>Hide candle</strong>
        </button>
      </div>
      
      <!-- Peace demonstration section -->
      <div class="peace-line-section">
        <h3>Students for Peace Demonstration Simulation</h3>
        <p class="peace-subtitle" id="sfp-subtitle"></p>
        
        <div class="peace-candle-grid" id="sfp-peaceCandleGrid" role="group" aria-label="Interactive candle memorial"></div>
        
        <div class="peace-counter">
          <span class="counter-display" id="sfp-counterDisplay" aria-live="polite" aria-atomic="true">0 / 33</span>
        </div>
        
        <div class="peace-message" id="sfp-congratsMessage" style="display: none;" role="status" aria-live="polite">
          üéâ <strong>Congratulations!</strong> <span id="sfp-congratsText"></span>
        </div>
        
        <div class="sfp-button-center">
          <button class="sfp-btn-peace sfp-btn-start" id="sfp-lightPeaceBtn" aria-live="polite">
            ‚ú® Light Candles
          </button>
          <button class="sfp-btn-peace sfp-btn-pause" id="sfp-pauseBtn" style="display: none;" aria-live="polite">
            ‚è∏Ô∏è Pause
          </button>
          <button class="sfp-btn-peace sfp-btn-resume" id="sfp-resumeBtn" style="display: none;" aria-live="polite">
            ‚ñ∂Ô∏è Resume
          </button>
          <button class="sfp-btn-peace sfp-btn-reset" id="sfp-resetBtn" style="display: none;" aria-live="polite">
            üîÑ Reset
          </button>
          <button class="sfp-btn-peace sfp-btn-restart" id="sfp-restartBtn" style="display: none;" aria-live="polite">
            üîÅ Restart
          </button>
        </div>
        
        <p class="peace-note">You may also click on any candle to toggle its flame on or off.</p>
      </div>
      
      <div class="sfp-button-center">
        <a href="/articles/students-for-peace/" class="sfp-btn-read">Read full article ‚Üí</a>
      </div>
    </div>
  </div>
</section>

<style>
.sfp-card {
  background: #fff;
  padding: 2rem;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  border-left: 5px solid #005cc5;
  position: relative;
  overflow: visible;
}

/* Wrapper for text with background candle */
.sfp-text-with-bg {
  position: relative;
  overflow: hidden;
  margin-bottom: 1rem;
}

/* Large background candle - ONLY behind the two paragraphs */
.sfp-candles-bg {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scale(1.5) scaleX(0.85) scaleY(1.2);
  opacity: 0.35;
  z-index: 0;
  pointer-events: none;
  transition: opacity 0.5s ease;
}

/* Show/Hide candle button - styled as link, right aligned */
.sfp-candle-toggle-line {
  text-align: right;
  margin: 1.5rem 0;
  position: relative;
  z-index: 1;
}

.sfp-candle-link {
  background: none;
  border: none;
  padding: 0;
  color: #005cc5;
  cursor: pointer;
  font-size: 1rem;
  font-family: inherit;
  text-decoration: none;
  transition: color 0.3s ease;
}

.sfp-candle-link:hover,
.sfp-candle-link:focus {
  color: #0366d6;
  text-decoration: underline;
}

.sfp-candle-link:focus {
  outline: 2px solid #0366d6;
  outline-offset: 2px;
}

/* Individual candle */
.sfp-candle {
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* Flame container */
.sfp-flame-container {
  position: relative;
  width: 40px;
  height: 70px;
  margin-bottom: -10px;
}

/* Flame glow */
.sfp-flame-glow {
  position: absolute;
  bottom: -15px;
  left: 50%;
  transform: translateX(-50%);
  width: 70px;
  height: 70px;
  background: radial-gradient(circle,
              rgba(255, 180, 50, 0.4) 0%,
              rgba(255, 150, 30, 0.25) 30%,
              rgba(255, 120, 0, 0.1) 50%,
              transparent 70%);
  border-radius: 50%;
  opacity: 0;
  transition: opacity 0.5s ease;
  filter: blur(8px);
}

.sfp-flame-glow.lit {
  opacity: 1;
  animation: glow 1.5s infinite alternate ease-in-out;
}

/* Realistic flame */
.sfp-flame {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 25px;
  height: 55px;
  opacity: 0;
  transition: opacity 0.5s ease;
}

.sfp-flame.lit {
  opacity: 1;
}

/* Blue base of flame */
.sfp-flame::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 18px;
  height: 12px;
  background: radial-gradient(ellipse at center bottom,
              rgba(70, 150, 255, 0.8) 0%,
              rgba(100, 180, 255, 0.6) 40%,
              transparent 80%);
  border-radius: 50% 50% 50% 50% / 40% 40% 60% 60%;
  animation: baseFlicker 1s ease-in-out infinite alternate;
}

/* Orange outer flame */
.sfp-flame::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 22px;
  height: 50px;
  background: linear-gradient(to top,
              rgba(255, 100, 0, 0) 0%,
              rgba(255, 120, 0, 0.7) 15%,
              rgba(255, 150, 30, 0.9) 35%,
              rgba(255, 180, 50, 0.8) 60%,
              rgba(255, 200, 100, 0.4) 85%,
              transparent 100%);
  border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
  clip-path: polygon(50% 0%, 80% 15%, 95% 40%, 100% 70%, 90% 90%, 50% 100%, 10% 90%, 0% 70%, 5% 40%, 20% 15%);
  animation: outerFlame 1.5s ease-in-out infinite alternate;
}

/* Yellow-white inner core */
.sfp-flame-core {
  position: absolute;
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  width: 12px;
  height: 38px;
  background: linear-gradient(to top,
              rgba(255, 230, 150, 0) 0%,
              rgba(255, 240, 180, 0.9) 20%,
              rgba(255, 250, 220, 1) 50%,
              rgba(255, 255, 240, 0.9) 75%,
              rgba(255, 255, 255, 0.6) 90%,
              transparent 100%);
  border-radius: 50% 50% 50% 50% / 80% 80% 20% 20%;
  clip-path: polygon(50% 0%, 70% 10%, 85% 30%, 90% 60%, 80% 85%, 50% 100%, 20% 85%, 10% 60%, 15% 30%, 30% 10%);
  animation: innerCore 1.2s ease-in-out infinite alternate;
}

/* Wick */
.sfp-wick {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 2px;
  height: 12px;
  background: linear-gradient(to top, #0a0a0a 0%, #2a2a2a 70%, #4a4a4a 100%);
  border-radius: 1px;
}

/* Candle body */
.sfp-candle-body {
  width: 40px;
  height: 120px;
  background: linear-gradient(to right,
              #d4c4a8 0%,
              #f5f0e1 20%,
              #fffef5 50%,
              #f5f0e1 80%,
              #d4c4a8 100%);
  border-radius: 3px 3px 0 0;
  box-shadow: inset 4px 0 12px rgba(0,0,0,0.2),
              inset -4px 0 12px rgba(0,0,0,0.2),
              inset 0 -8px 15px rgba(0,0,0,0.15);
  position: relative;
}

.sfp-candle-body::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 10px;
  background: radial-gradient(ellipse at center,
              #fffef5 0%,
              #f5f0e1 60%,
              #d4c4a8 100%);
  border-radius: 50%;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.25);
}

/* Candle base */
.sfp-candle-base {
  width: 50px;
  height: 15px;
  background: linear-gradient(to bottom,
              #9d8269 0%,
              #7d6850 50%,
              #5d4838 100%);
  border-radius: 0 0 5px 5px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.5),
              inset 0 1px 2px rgba(255,255,255,0.15);
}

/* Flame animations */
@keyframes outerFlame {
  0% {
    transform: translateX(-50%) scaleY(1) scaleX(1) translateY(0);
    opacity: 0.85;
  }
  100% {
    transform: translateX(-50%) scaleY(1.08) scaleX(0.94) translateY(-3px);
    opacity: 0.95;
  }
}

@keyframes innerCore {
  0% {
    transform: translateX(-50%) scaleY(1) scaleX(1);
    opacity: 1;
  }
  100% {
    transform: translateX(-50%) scaleY(1.05) scaleX(0.96);
    opacity: 0.9;
  }
}

@keyframes baseFlicker {
  0% {
    transform: translateX(-50%) scaleX(1);
    opacity: 0.7;
  }
  100% {
    transform: translateX(-50%) scaleX(1.15);
    opacity: 0.9;
  }
}

@keyframes glow {
  0% {
    transform: translateX(-50%) scale(1);
    opacity: 0.6;
  }
  100% {
    transform: translateX(-50%) scale(1.12);
    opacity: 0.75;
  }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
  .peace-mini-flame,
  .sfp-flame,
  .sfp-flame-glow,
  .peace-mini-flame::before,
  .peace-mini-flame::after,
  .peace-mini-flame-core,
  .sfp-flame::before,
  .sfp-flame::after,
  .sfp-flame-core {
    animation: none !important;
  }
}

/* Content wrapper */
.sfp-content {
  position: relative;
  z-index: 1;
}

.sfp-content p {
  margin-bottom: 1rem;
  line-height: 1.7;
  position: relative;
  z-index: 1;
}

.sfp-years-ago {
  text-align: center;
  font-size: 1.5rem;
  font-weight: 700;
  margin-bottom: 1.5rem !important;
  color: #0a2e57;
}

/* Center aligned button container */
.sfp-button-center {
  text-align: center;
  margin: 1.5rem 0;
  display: flex;
  gap: 0.75rem;
  justify-content: center;
  flex-wrap: wrap;
}

/* Peace demonstration section */
.peace-line-section {
  background: rgba(74, 144, 226, 0.05);
  padding: 2rem 1.5rem;
  border-radius: 12px;
  margin: 2rem 0;
  border: 2px solid rgba(74, 144, 226, 0.2);
  text-align: center;
}

.peace-line-section h3 {
  color: #0a2e57;
  margin: 0 0 0.5rem 0;
}

.peace-subtitle {
  margin: 0 0 1.5rem 0;
}

/* Peace candle grid */
.peace-candle-grid {
  display: grid;
  grid-template-columns: repeat(11, 1fr);
  gap: 12px;
  max-width: 800px;
  margin: 0 auto 1.5rem auto;
  justify-items: center;
}

.peace-mini-candle {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.peace-mini-candle:hover {
  transform: scale(1.1);
}

/* Remove blue outline on click */
.peace-mini-candle:focus {
  outline: none;
}

.peace-mini-flame-container {
  position: relative;
  width: 16px;
  height: 28px;
  margin-bottom: -5px;
}

.peace-mini-flame {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 10px;
  height: 24px;
  opacity: 0;
  transition: opacity 0.8s ease;
}

.peace-mini-flame.lit {
  opacity: 1;
}

.peace-mini-flame::before {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 8px;
  height: 5px;
  background: radial-gradient(ellipse at center bottom,
              rgba(70, 150, 255, 0.7) 0%,
              rgba(100, 180, 255, 0.5) 40%,
              transparent 80%);
  border-radius: 50%;
}

.peace-mini-flame::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 9px;
  height: 22px;
  background: linear-gradient(to top,
              rgba(255, 100, 0, 0) 0%,
              rgba(255, 120, 0, 0.7) 15%,
              rgba(255, 150, 30, 0.9) 35%,
              rgba(255, 180, 50, 0.8) 60%,
              rgba(255, 200, 100, 0.4) 85%,
              transparent 100%);
  border-radius: 50% 50% 50% 50% / 70% 70% 30% 30%;
  clip-path: polygon(50% 0%, 80% 15%, 95% 40%, 100% 70%, 90% 90%, 50% 100%, 10% 90%, 0% 70%, 5% 40%, 20% 15%);
}

.peace-mini-flame-core {
  position: absolute;
  bottom: 3px;
  left: 50%;
  transform: translateX(-50%);
  width: 5px;
  height: 17px;
  background: linear-gradient(to top,
              rgba(255, 230, 150, 0) 0%,
              rgba(255, 240, 180, 0.9) 20%,
              rgba(255, 250, 220, 1) 50%,
              rgba(255, 255, 240, 0.9) 75%,
              rgba(255, 255, 255, 0.6) 90%,
              transparent 100%);
  border-radius: 50% 50% 50% 50% / 80% 80% 20% 20%;
  clip-path: polygon(50% 0%, 70% 10%, 85% 30%, 90% 60%, 80% 85%, 50% 100%, 20% 85%, 10% 60%, 15% 30%, 30% 10%);
}

/* VARIED animations for each candle */
.peace-mini-candle:nth-child(3n+1) .peace-mini-flame::before {
  animation: baseFlicker 0.9s ease-in-out infinite alternate;
}
.peace-mini-candle:nth-child(3n+1) .peace-mini-flame::after {
  animation: outerFlame 1.3s ease-in-out infinite alternate;
}
.peace-mini-candle:nth-child(3n+1) .peace-mini-flame-core {
  animation: innerCore 1.1s ease-in-out infinite alternate;
}

.peace-mini-candle:nth-child(3n+2) .peace-mini-flame::before {
  animation: baseFlicker 1.1s ease-in-out infinite alternate;
}
.peace-mini-candle:nth-child(3n+2) .peace-mini-flame::after {
  animation: outerFlame 1.6s ease-in-out infinite alternate;
}
.peace-mini-candle:nth-child(3n+2) .peace-mini-flame-core {
  animation: innerCore 1.4s ease-in-out infinite alternate;
}

.peace-mini-candle:nth-child(3n+3) .peace-mini-flame::before {
  animation: baseFlicker 1.0s ease-in-out infinite alternate;
}
.peace-mini-candle:nth-child(3n+3) .peace-mini-flame::after {
  animation: outerFlame 1.8s ease-in-out infinite alternate;
}
.peace-mini-candle:nth-child(3n+3) .peace-mini-flame-core {
  animation: innerCore 1.5s ease-in-out infinite alternate;
}

/* Mini candle wick */
.peace-mini-wick {
  position: absolute;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 1.2px;
  height: 8px;
  background: linear-gradient(to top, #0a0a0a 0%, #2a2a2a 70%, #4a4a4a 100%);
  z-index: 1;
}

.peace-mini-body {
  width: 16px;
  height: 50px;
  background: linear-gradient(to right,
              #d4c4a8 0%,
              #f5f0e1 20%,
              #fffef5 50%,
              #f5f0e1 80%,
              #d4c4a8 100%);
  border-radius: 2px 2px 0 0;
  box-shadow: inset 2px 0 5px rgba(0,0,0,0.2),
              inset -2px 0 5px rgba(0,0,0,0.2);
  position: relative;
}

.peace-mini-body::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: radial-gradient(ellipse at center,
              #fffef5 0%,
              #f5f0e1 60%,
              #d4c4a8 100%);
  border-radius: 50%;
}

.peace-mini-base {
  width: 20px;
  height: 6px;
  background: linear-gradient(to bottom,
              #9d8269 0%,
              #7d6850 50%,
              #5d4838 100%);
  border-radius: 0 0 3px 3px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
}

/* Counter display */
.peace-counter {
  margin: 1rem 0;
}

.counter-display {
  display: inline-block;
  font-size: 1.3rem;
  font-weight: 700;
  color: #4a90e2;
  background: rgba(74, 144, 226, 0.1);
  padding: 0.4rem 1rem;
  border-radius: 8px;
  border: 2px solid rgba(74, 144, 226, 0.3);
}

/* Congratulations message */
.peace-message {
  background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
  color: #fff;
  padding: 1.2rem 1.5rem;
  border-radius: 12px;
  margin: 1.5rem 0;
  font-size: 1.1rem;
  box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
  animation: fadeInScale 0.6s ease-out;
}

@keyframes fadeInScale {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Peace note */
.peace-note {
  margin: 1.2rem 0 0.5rem 0;
}

/* Peace lighting buttons */
.sfp-btn-peace {
  padding: 0.85rem 2rem;
  color: #fff;
  border: none;
  border-radius: 10px;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.sfp-btn-start {
  background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
}

.sfp-btn-start:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(34, 197, 94, 0.5);
  background: linear-gradient(135deg, #16a34a 0%, #15803d 100%);
}

.sfp-btn-pause {
  background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%);
  box-shadow: 0 4px 12px rgba(234, 179, 8, 0.4);
}

.sfp-btn-pause:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(234, 179, 8, 0.5);
  background: linear-gradient(135deg, #ca8a04 0%, #a16207 100%);
}

.sfp-btn-resume {
  background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
  box-shadow: 0 4px 12px rgba(20, 184, 166, 0.4);
}

.sfp-btn-resume:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(20, 184, 166, 0.5);
  background: linear-gradient(135deg, #0d9488 0%, #0f766e 100%);
}

.sfp-btn-reset {
  background: linear-gradient(135deg, #9f1239 0%, #881337 100%);
  box-shadow: 0 4px 12px rgba(159, 18, 57, 0.4);
}

.sfp-btn-reset:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(159, 18, 57, 0.5);
  background: linear-gradient(135deg, #881337 0%, #701a36 100%);
}

.sfp-btn-restart {
  background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
  box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
}

.sfp-btn-restart:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(124, 58, 237, 0.5);
  background: linear-gradient(135deg, #6d28d9 0%, #5b21b6 100%);
}

.sfp-btn-peace:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

/* Read article button */
.sfp-btn-read {
  display: inline-block;
  padding: 0.9rem 2.5rem;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #fff;
  border: none;
  border-radius: 10px;
  font-weight: 600;
  font-size: 1rem;
  text-decoration: none;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
}

.sfp-btn-read:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 18px rgba(102, 126, 234, 0.5);
  background: linear-gradient(135deg, #5568d3 0%, #63398e 100%);
  color: #fff;
  text-decoration: none;
}

/* Mobile adjustments */
@media (max-width: 1024px) {
  .peace-candle-grid {
    grid-template-columns: repeat(11, 1fr);
    gap: 10px;
  }
}

@media (max-width: 768px) {
  .sfp-card {
    padding: 1.5rem;
  }
  
  .sfp-candles-bg {
    opacity: 0.25;
    transform: translate(-50%, -50%) scale(1.8) scaleX(0.85) scaleY(1.2);
  }
  
  .sfp-candle-toggle-line {
    text-align: right;
    margin: 1.25rem 0;
  }
  
  .peace-candle-grid {
    grid-template-columns: repeat(6, 1fr);
    gap: 10px;
  }
  
  .counter-display {
    font-size: 1.5rem;
    padding: 0.4rem 1.2rem;
  }
  
  .peace-message {
    font-size: 1rem;
    padding: 1rem 1.2rem;
  }
  
  .sfp-btn-peace {
    padding: 0.7rem 1.5rem;
    font-size: 0.9rem;
  }
  
  .sfp-btn-read {
    padding: 0.75rem 2rem;
    font-size: 0.95rem;
  }
}

@media (max-width: 480px) {
  .sfp-card {
    padding: 1.25rem;
  }
  
  .sfp-candles-bg {
    opacity: 0.2;
    transform: translate(-50%, -50%) scale(1.2) scaleX(0.85) scaleY(1.2);
  }
  
  .peace-line-section {
    padding: 1.5rem 1rem;
  }
  
  .peace-candle-grid {
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
  }
  
  .peace-mini-body {
    height: 40px;
    width: 14px;
  }
  
  .peace-mini-base {
    width: 18px;
    height: 5px;
  }
  
  .peace-mini-flame-container {
    width: 14px;
    height: 24px;
  }
  
  .counter-display {
    font-size: 1.3rem;
    padding: 0.4rem 1rem;
  }
  
  .peace-message {
    font-size: 0.95rem;
    padding: 1rem;
  }
  
  .sfp-button-center {
    flex-direction: column;
    align-items: stretch;
  }
  
  .sfp-btn-peace {
    padding: 0.7rem 1.2rem;
    font-size: 0.85rem;
  }
  
  .sfp-btn-read {
    padding: 0.7rem 1.5rem;
    font-size: 0.9rem;
  }
}
  .peace-line-section h3 .header-link {
  display: none !important;
}
</style>

<script>
(function() {
  'use strict';
  
  const section = document.getElementById('students-for-peace');
  if (!section) return;

  // Calculate anniversary dynamically
  const currentYear = new Date().getFullYear();
  const anniversary = currentYear - 1993;
  const totalCandles = anniversary;

  let lightingInterval = null;
  let currentCount = 0;

  const grid = section.querySelector('#sfp-peaceCandleGrid');
  const counterDisplay = section.querySelector('#sfp-counterDisplay');
  const congratsMessage = section.querySelector('#sfp-congratsMessage');
  const congratsText = section.querySelector('#sfp-congratsText');
  const subtitle = section.querySelector('#sfp-subtitle');
  const largeCandleBg = section.querySelector('#sfp-largeCandleBg');
  const toggleLink = section.querySelector('#sfp-toggleLargeCandleLink');

  // Set dynamic subtitle
  if (subtitle) {
    subtitle.textContent = totalCandles + ' candles commemorating ' + anniversary + ' years (1993‚Äì' + currentYear + ')';
  }

  // Set dynamic congratulations message
  if (congratsText) {
    const suffix = anniversary === 1 ? 'st' : anniversary === 2 ? 'nd' : anniversary === 3 ? 'rd' : 'th';
    congratsText.textContent = 'You have lit ' + totalCandles + ' candles on the ' + anniversary + suffix + ' anniversary of Students for Peace.';
  }

  function showButton(id) {
    const btn = section.querySelector('#' + id);
    if (btn) btn.style.display = 'inline-block';
  }

  function hideButton(id) {
    const btn = section.querySelector('#' + id);
    if (btn) btn.style.display = 'none';
  }

  function lightFlame(flame) {
    flame.classList.add('lit');
  }

  function extinguishFlame(flame) {
    flame.classList.remove('lit');
  }

  function updateCounter(count) {
    if (counterDisplay) {
      counterDisplay.textContent = count + ' / ' + totalCandles;
    }
  }

  function showCongratsMessage() {
    if (congratsMessage) congratsMessage.style.display = 'block';
  }

  function hideCongratsMessage() {
    if (congratsMessage) congratsMessage.style.display = 'none';
  }

  function createPeaceCandles() {
    if (!grid) return;
    grid.innerHTML = '';

    for (let i = 0; i < totalCandles; i++) {
      const mini = document.createElement('div');
      mini.className = 'peace-mini-candle';
      mini.setAttribute('tabindex', '0');
      mini.setAttribute('aria-label', 'Candle ' + (i + 1));
      mini.dataset.index = i;

      mini.innerHTML = '<div class="peace-mini-flame-container">' +
        '<div class="peace-mini-flame">' +
        '<div class="peace-mini-flame-core"></div>' +
        '</div>' +
        '<div class="peace-mini-wick"></div>' +
        '</div>' +
        '<div class="peace-mini-body"></div>' +
        '<div class="peace-mini-base"></div>';

      mini.addEventListener('click', function() {
        const flame = mini.querySelector('.peace-mini-flame');
        if (flame.classList.contains('lit')) {
          extinguishFlame(flame);
        } else {
          lightFlame(flame);
        }
        updateCounterFromCandles();
      });

      mini.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          mini.click();
        }
      });

      grid.appendChild(mini);
    }
  }

  function updateCounterFromCandles() {
    const flames = section.querySelectorAll('.peace-mini-flame');
    const lit = Array.from(flames).filter(function(f) {
      return f.classList.contains('lit');
    }).length;
    updateCounter(lit);

    if (lit === totalCandles) showCongratsMessage();
    else hideCongratsMessage();
  }

  function startPeaceLighting() {
    const flames = section.querySelectorAll('.peace-mini-flame');

    hideButton('sfp-lightPeaceBtn');
    showButton('sfp-pauseBtn');
    showButton('sfp-resetBtn');

    currentCount = 0;
    hideCongratsMessage();
    flames.forEach(extinguishFlame);
    updateCounter(0);

    lightingInterval = setInterval(function() {
      if (currentCount < totalCandles) {
        lightFlame(flames[currentCount]);
        currentCount++;
        updateCounter(currentCount);

        if (currentCount === totalCandles) {
          clearInterval(lightingInterval);
          lightingInterval = null;
          hideButton('sfp-pauseBtn');
          showButton('sfp-restartBtn');
          showCongratsMessage();
        }
      }
    }, 600);
  }

  function pauseLighting() {
    if (lightingInterval) {
      clearInterval(lightingInterval);
      lightingInterval = null;
    }
    hideButton('sfp-pauseBtn');
    showButton('sfp-resumeBtn');
  }

  function resumeLighting() {
    const flames = section.querySelectorAll('.peace-mini-flame');
    hideButton('sfp-resumeBtn');
    showButton('sfp-pauseBtn');

    lightingInterval = setInterval(function() {
      if (currentCount < totalCandles) {
        lightFlame(flames[currentCount]);
        currentCount++;
        updateCounter(currentCount);

        if (currentCount === totalCandles) {
          clearInterval(lightingInterval);
          lightingInterval = null;
          hideButton('sfp-pauseBtn');
          showButton('sfp-restartBtn');
          showCongratsMessage();
        }
      }
    }, 600);
  }

  function resetLighting() {
    if (lightingInterval) {
      clearInterval(lightingInterval);
      lightingInterval = null;
    }

    const flames = section.querySelectorAll('.peace-mini-flame');
    flames.forEach(extinguishFlame);

    currentCount = 0;
    updateCounter(0);
    hideCongratsMessage();

    hideButton('sfp-pauseBtn');
    hideButton('sfp-resumeBtn');
    hideButton('sfp-resetBtn');
    hideButton('sfp-restartBtn');
    showButton('sfp-lightPeaceBtn');
  }

  function restartLighting() {
    resetLighting();
    startPeaceLighting();
  }

  function toggleLargeCandle() {
    if (!largeCandleBg || !toggleLink) return;
    
    if (largeCandleBg.style.display === 'none') {
      largeCandleBg.style.display = 'block';
      toggleLink.innerHTML = 'üïØÔ∏è <strong>Hide candle</strong>';
      toggleLink.setAttribute('aria-expanded', 'true');
    } else {
      largeCandleBg.style.display = 'none';
      toggleLink.innerHTML = 'üïØÔ∏è <strong>Show candle</strong>';
      toggleLink.setAttribute('aria-expanded', 'false');
    }
  }

  // Attach event listeners
  const lightBtn = section.querySelector('#sfp-lightPeaceBtn');
  const pauseBtn = section.querySelector('#sfp-pauseBtn');
  const resumeBtn = section.querySelector('#sfp-resumeBtn');
  const resetBtn = section.querySelector('#sfp-resetBtn');
  const restartBtn = section.querySelector('#sfp-restartBtn');

  if (lightBtn) lightBtn.addEventListener('click', startPeaceLighting);
  if (pauseBtn) pauseBtn.addEventListener('click', pauseLighting);
  if (resumeBtn) resumeBtn.addEventListener('click', resumeLighting);
  if (resetBtn) resetBtn.addEventListener('click', resetLighting);
  if (restartBtn) restartBtn.addEventListener('click', restartLighting);
  if (toggleLink) toggleLink.addEventListener('click', toggleLargeCandle);

  // Initialize
  createPeaceCandles();

})();
</script>
